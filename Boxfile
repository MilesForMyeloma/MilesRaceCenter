global:
  env:
    - LARAVEL_ENV: production
web1:
  name: laravel4
  document_root: public
  shared_writable_dirs:
    - app/storage/cache
    - app/storage/logs
    - app/storage/meta
    - app/storage/sessions
    - app/storage/views
  php_extensions:
    - pdo_mysql
    - mcrypt
    - mbstring
    - curl
  zend_extensions:
    - xcache
    - xdebug
  after_build:
    - "if [ ! -f composer.phar ]; then curl -s http://getcomposer.org/installer | php; fi;"
    - "php composer.phar --prefer-source install"
  before_deploy:
    - "php artisan migrate:install"
    - "php artisan migrate"
    - "php artisan migrate --package=cartalyst/sentry"
    - "php artisan db:seed"
  after_deploy:
    - "rm -f storage/cache/*"
    - "rm -f storage/views/*"
